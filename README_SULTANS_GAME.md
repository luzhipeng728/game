# 🏰 苏丹的游戏 - 多智能体卡牌系统

一个基于CrewAI的多智能体对话系统，模拟《苏丹的游戏》中的妓院场景交互。

## ✨ 特色功能

### � 丰富的卡牌系统
- **4种卡牌类型**：纵欲、奢靡、征服、杀戮
- **4个品级等级**：岩石、青铜、白银、黄金
- **16种组合**：每种组合都有独特的任务和奖励机制

### 🤖 智能体交互系统
- **随从智能体**：执行主人的秘密任务，善于隐匿和社交
- **妓女智能体**：魅惑而聪慧，善于读心和操控
- **老鸨智能体**：精明的管理者，保护妓院利益和姑娘安全
- **旁白智能体**：全知视角，营造氛围，推动剧情发展

### � 完整的游戏机制
- **关系系统**：角色间关系会根据互动动态变化
- **场景数值**：紧张度、暧昧度、危险度等实时更新
- **骰子检定**：基于角色属性的随机事件判定
- **沉浸式叙事**：AI驱动的剧情发展和角色对话

## 🚀 快速开始

### � 系统要求
- Python 3.8+
- 稳定的网络连接

### 🔧 环境配置

**API已预配置完成！** 无需手动设置API密钥，系统已集成以下配置：
- ✅ **模型**: gpt-4.1-nano
- ✅ **API Base**: https://api.hyprlab.io/v1
- ✅ **API Key**: 已内置

### � 依赖安装

```bash
# 安装所需依赖
pip install crewai langchain-openai streamlit python-dotenv

# 或使用 requirements.txt
pip install -r requirements.txt
```

### 🎯 运行游戏

#### 方法1：使用启动脚本（推荐）
```bash
python3 start_game.py
```

启动脚本提供以下选项：
1. 🎮 **Streamlit 游戏界面** - 完整的可视化游戏体验
2. 🎭 **妓院场景演示** - 命令行交互演示
3. 🔧 **系统测试** - 验证所有组件功能

#### 方法2：直接运行组件

**运行可视化界面：**
```bash
streamlit run sultans_game_app.py
```

然后访问 http://localhost:8501

**运行演示场景：**
```bash
python3 demo_brothel_scene.py
```

**运行系统测试：**
```bash
python3 test_system.py
```

## 🎮 游戏玩法

### 🎴 卡牌系统详解

#### 纵欲类卡牌
- **岩石级**：妓院寻欢 - 基础的肉体交易
- **青铜级**：美人计 - 利用魅力获取信息
- **白银级**：春宫夜宴 - 奢华的享乐聚会
- **黄金级**：倾城之恋 - 征服传说中的美人

#### 奢靡类卡牌
- **岩石级**：购买珠宝 - 用金钱展示地位
- **青铜级**：丝绸之路 - 奢华商品贸易
- **白银级**：宫廷盛宴 - 举办豪华宴会
- **黄金级**：黄金宫殿 - 建造奢华建筑

#### 征服类卡牌
- **岩石级**：镇压盗匪 - 维护地区秩序
- **青铜级**：占领要塞 - 军事战略行动
- **白银级**：远征异域 - 开拓新的领土
- **黄金级**：称霸一方 - 成为地区霸主

#### 杀戮类卡牌
- **岩石级**：街头冲突 - 解决帮派纠纷
- **青铜级**：刺客任务 - 暗杀指定目标
- **白银级**：血洗仇敌 - 大规模报复行动
- **黄金级**：屠城之夜 - 毁灭性的军事行动

### 🎭 智能体角色

#### 随从智能体
- **职责**：忠实执行卡牌任务，保持隐蔽身份
- **特长**：隐匿、社交、观察力
- **目标**：完成任务同时避免暴露真实意图

#### 妓女智能体
- **职责**：通过魅力建立关系，探知客人意图
- **特长**：魅力、智慧、心理操控
- **目标**：获得利益同时保护自身安全

#### 老鸨智能体
- **职责**：管理妓院，保护姑娘们，最大化利润
- **特长**：商业头脑、人际关系、风险控制
- **目标**：维护妓院声誉和利益

#### 旁白智能体
- **职责**：营造氛围，推动剧情，控制节奏
- **特长**：全知视角、叙事技巧、氛围渲染
- **目标**：创造沉浸式的游戏体验

### � 游戏机制

#### 关系系统
- 角色间关系值范围 0-100
- 关系会根据互动结果动态变化
- 影响后续对话选择和事件结果

#### 场景数值
- **紧张度**：情况的紧急程度
- **暧昧度**：浪漫和诱惑的氛围
- **危险度**：潜在风险和威胁
- **金钱消费**：经济活动的记录

#### 骰子检定
- 基于角色属性进行随机判定
- 属性包括：魅力、智慧、体魄、战斗、社交、隐匿
- 成功率受属性值和难度影响

## 🛠️ 项目结构

```
sultans_game/
├── models.py          # 数据模型定义
├── agents.py          # 智能体创建和管理
├── cards.py           # 卡牌生成系统
├── tools.py           # 游戏工具和机制
├── config.py          # API配置管理
└── __init__.py        # 包初始化

scripts/
├── sultans_game_app.py    # Streamlit界面
├── demo_brothel_scene.py  # 演示场景
├── test_system.py         # 系统测试
└── start_game.py          # 启动脚本
```

## 🔧 系统测试

运行完整的系统测试：
```bash
python3 test_system.py
```

测试内容包括：
- ✅ 模块导入检查
- ✅ 数据模型功能
- ✅ 卡牌生成系统
- ✅ 工具系统功能
- ✅ API配置验证
- ✅ 智能体创建
- ✅ 游戏主控制器

## 🎯 使用建议

### 🎮 最佳游戏体验
- 使用Streamlit界面获得最佳视觉体验
- 仔细阅读卡牌描述制定策略
- 观察角色关系变化调整策略
- 关注场景数值变化把握时机

### 🛠️ 开发者选项
- 选择合适的模型（gpt-4.1-nano性价比高）
- 调整智能体的创造性参数
- 自定义场景数值和判定规则
- 扩展新的卡牌类型和智能体

### 🐛 故障排除
- 确保网络连接稳定
- 检查Python版本（需要3.8+）
- 验证所有依赖包已正确安装
- 查看控制台错误信息

## � 更新日志

### v2.0.0 (当前版本)
- ✅ **API预配置**：用户无需手动设置API密钥
- ✅ **模型升级**：使用gpt-4.1-nano模型
- ✅ **启动脚本**：一键启动各种游戏组件
- ✅ **配置优化**：自动化配置管理
- ✅ **用户体验**：简化安装和使用流程

### v1.0.0
- 🎮 完整的多智能体卡牌系统
- 🎴 16种卡牌组合
- 🤖 4个智能体角色
- 🎭 妓院场景模拟
- 📊 关系和数值系统
- 🖥️ Streamlit可视化界面

## 🤝 贡献指南

欢迎为项目做出贡献！你可以：
- 🐛 报告bug和问题
- 💡 提出新功能建议
- 🔧 提交代码改进
- 📚 完善文档说明

## 📄 许可证

本项目遵循MIT许可证，详见LICENSE文件。

## 🙏 致谢

- **CrewAI**：提供强大的多智能体框架
- **LangChain**：AI应用开发工具链
- **Streamlit**：优秀的Python Web应用框架
- **OpenAI**：语言模型API服务

---

🏰 **享受你的苏丹之旅！** 🏰